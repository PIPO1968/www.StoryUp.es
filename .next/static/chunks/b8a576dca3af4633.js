(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56095,e=>{"use strict";var t=e.i(43476),s=e.i(71645);let a=({nick:e,className:a})=>{let[l,r]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{if(e)try{let t=await fetch(`/api/user/premium-status?nick=${encodeURIComponent(e)}`),s=await t.json();r(s.isPremium||!1)}catch(e){r(!1)}})()},[e]);let n=(e||"").trim().toLowerCase();return e&&"anonimo"!==n&&"anÃ³nimo"!==n?(0,t.jsxs)("a",{href:`/perfil/${encodeURIComponent(e)}`,className:a||"text-blue-600 underline hover:text-blue-800",title:`Ver perfil de ${e}${l?" (Usuario Premium)":""}`,children:[e,l&&(0,t.jsx)("span",{className:"ml-1 inline-flex items-center",children:(0,t.jsx)("span",{className:"bg-gradient-to-r from-sky-100 to-blue-100 text-amber-900 text-xs px-2 py-1 rounded-full font-bold shadow-md border border-sky-300",title:"Usuario Premium",children:"ðŸ‘‘"})})]}):(0,t.jsx)("span",{className:a||"text-gray-500",children:e||"(sin nick)"})};function l(e,s){return(0,t.jsx)(a,{nick:e,className:s})}e.s(["renderNick",()=>l],56095)},56553,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(56095);function l(){let e,l,r,n,c,d,[i,o]=s.default.useState(!0),[x,m]=s.default.useState([]),[h,p]=s.default.useState(""),[u,g]=s.default.useState([]),[j,b]=s.default.useState([]),[N,f]=s.default.useState([]),[y,w]=s.default.useState(null);s.default.useEffect(()=>{let e,t,s,a,l,r=localStorage.getItem("currentUser");if(r)try{let e=JSON.parse(r);w(e)}catch(e){console.error("Error al cargar datos de usuario:",e)}let n=Object.keys(window.localStorage).filter(e=>e.startsWith("campeonato_individual_t")||e.startsWith("campeonato_centros_t")||e.startsWith("campeonato_docentes_t")).map(e=>{let t=e.match(/t(\d+)/);return t?`t${t[1]}`:null}).filter(e=>null!==e).filter((e,t,s)=>s.indexOf(e)===t),c=(t=(e=new Date).getFullYear(),s=e.getMonth()+1,a=e.getDate(),l=t,(s<9||9===s&&a<30)&&(l=t-1),`t${l}`);n.includes(c)||n.push(c),n.sort((e,t)=>{let s=parseInt(e.replace("t",""));return parseInt(t.replace("t",""))-s}),m(n),p(c);let d=new Date,i=9===d.getMonth()&&1===d.getDate(),o=localStorage.getItem("lastSeasonResetYear");if(i&&o!==String(d.getFullYear())){let e=d.getFullYear()-1,t=`campeonato_centros_t${e}`,s=`campeonato_individual_t${e}`,a=`campeonato_docentes_t${e}`;localStorage.removeItem(t),localStorage.removeItem(s),localStorage.removeItem(a),localStorage.setItem("lastSeasonResetYear",String(d.getFullYear())),console.log(`Temporada ${e} reseteada autom\xe1ticamente el 1 de octubre.`)}},[]),s.default.useEffect(()=>{let e,t,s;if(!h)return;let a=(e=`campeonato_centros_${h}`,t=JSON.parse(window.localStorage.getItem(e)||"{}"),s=[],Object.entries(t).forEach(([e,t])=>{(t.preguntasAcertadas??0)>=1&&s.push({escudo:t.escudo||"ðŸ«",nombre:e,ganados:t.ganados??0,perdidos:t.perdidos??0,preguntasAcertadas:t.preguntasAcertadas??0,preguntasFalladas:t.preguntasFalladas??0,likes:t.likes??0})}),s.sort((e,t)=>t.likes-e.likes),s.slice(0,25)),l=function(e){let t=`campeonato_individual_${e}`,s=JSON.parse(window.localStorage.getItem(t)||"{}"),a=window.localStorage.getItem("users");if(!a)return Array.from({length:25},()=>({escudo:"ðŸ‘¤",nombre:"AÃºn no hay alumno",ganados:0,perdidos:0,preguntasAcertadas:0,preguntasFalladas:0,likes:0}));let l=JSON.parse(a).filter(e=>"docente"!==(e.tipo||"").toLowerCase()),r=[];return l.forEach(e=>{let t=s[(e.nick||"").toLowerCase().replace(/\s+/g,"")]||{};(t.preguntasAcertadas??0)>=1&&r.push({escudo:e.escudo||"ðŸ‘¤",nombre:e.nick,ganados:t.ganados??0,perdidos:t.perdidos??0,preguntasAcertadas:t.preguntasAcertadas??0,preguntasFalladas:t.preguntasFalladas??0,likes:t.likes??0})}),r.sort((e,t)=>t.likes-e.likes),r.slice(0,25)}(h),r=function(e){let t=e.replace(/\D/g,""),s=`campeonato_docentes_t${t}`,a=JSON.parse(window.localStorage.getItem(s)||"{}"),l=window.localStorage.getItem("users");if(!l)return[];let r=JSON.parse(l).filter(e=>"docente"===(e.tipo||"").toLowerCase()),n=[];return r.forEach(e=>{let t=a[(e.nick||"").toLowerCase().replace(/\s+/g,"")]||{};(t.preguntasAcertadas??t.acertadas??0)>=1&&n.push({escudo:e.escudo||"ðŸ‘¨â€ðŸ«",nombre:e.nick,ganados:t.ganados??t.ganado??0,perdidos:t.perdidos??t.perdido??0,preguntasAcertadas:t.preguntasAcertadas??t.acertadas??0,preguntasFalladas:t.preguntasFalladas??t.falladas??0,likes:t.likes??0})}),n.sort((e,t)=>t.likes-e.likes).slice(0,25)}(h);g(a),b(l),f(r),o(!1)},[h]);let v=(l=(e=new Date).getFullYear(),r=e.getMonth()+1,n=e.getDate(),c=new Date(l,8,30),(r>9||9===r&&n>=30)&&(c=new Date(l+1,8,30)),d=Math.ceil((c.getTime()-e.getTime())/864e5),{temporadaActual:h.replace("t",""),finTemporada:c.toLocaleDateString("es-ES"),diasRestantes:d>0?d:0});return i||!h?(0,t.jsx)("div",{className:"min-h-screen bg-green-100 p-8 text-center text-lg",children:"Cargando competiciones..."}):(0,t.jsxs)("div",{className:"min-h-screen bg-green-100 p-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Competiciones StoryUp"}),(0,t.jsx)("div",{className:"max-w-6xl mx-auto mb-6",children:(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-300 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-blue-700",children:"ðŸ“… InformaciÃ³n de Temporada"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("label",{className:"font-semibold mr-2 text-blue-700",children:"Ver temporada:"}),(0,t.jsx)("select",{className:"border rounded px-3 py-2 bg-white shadow",value:h,onChange:e=>p(e.target.value),children:x.map((e,s)=>(0,t.jsx)("option",{value:e,children:`Temporada ${e.replace("t","")}${e===x[0]?" (Actual)":""}`},s))})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"bg-white rounded p-3 border border-blue-200",children:[(0,t.jsx)("div",{className:"font-semibold text-blue-600",children:"Temporada Actual:"}),(0,t.jsx)("div",{className:"text-lg font-bold",children:v.temporadaActual})]}),(0,t.jsxs)("div",{className:"bg-white rounded p-3 border border-green-200",children:[(0,t.jsx)("div",{className:"font-semibold text-green-600",children:"Fin de Temporada:"}),(0,t.jsx)("div",{className:"text-lg font-bold",children:v.finTemporada})]}),(0,t.jsxs)("div",{className:"bg-white rounded p-3 border border-orange-200",children:[(0,t.jsx)("div",{className:"font-semibold text-orange-600",children:"DÃ­as Restantes:"}),(0,t.jsxs)("div",{className:"text-lg font-bold",children:[v.diasRestantes," dÃ­as"]})]})]}),(0,t.jsxs)("div",{className:"mt-3 text-xs text-gray-600",children:["ðŸ’¡ ",(0,t.jsx)("strong",{children:"Sistema de Temporadas:"})," Cada temporada termina el 30 de septiembre. Los datos se mantienen guardados y puedes consultar temporadas anteriores usando el selector de arriba.",x.length>1&&` Hay ${x.length} temporada${x.length>1?"s":""} disponible${x.length>1?"s":""}.`]})]})}),(0,t.jsx)("div",{className:"max-w-5xl mx-auto mb-6",children:(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-300 rounded p-3 text-sm text-gray-700",children:[(0,t.jsx)("b",{children:"Importante:"})," Solo se contabilizan en estas tablas los datos obtenidos en ",(0,t.jsx)("span",{className:"font-bold text-blue-700",children:"modo competicion"}),".",(0,t.jsx)("br",{}),"Las partidas en modo clÃ¡sico no afectan los rankings ni las estadÃ­sticas de competiciÃ³n."]})}),(0,t.jsxs)("div",{className:"flex flex-col gap-8 max-w-5xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-8 w-full max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-3 w-1/2 text-[11px]",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-center mb-4",children:"CompeticiÃ³n Centros"}),(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-green-100",children:[(0,t.jsx)("th",{className:"py-2 text-center",children:"PG"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"EC"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"CE"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"G"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"P"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"PA"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"PF"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"â¤ï¸"})]})}),(0,t.jsx)("tbody",{children:u.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-0 text-center font-bold",children:s+1}),(0,t.jsx)("td",{className:"py-0 text-center",children:(0,t.jsx)("span",{className:"inline-block w-8 h-8 text-2xl align-middle",children:e.escudo})}),(0,t.jsx)("td",{className:"py-0 font-semibold",children:(0,t.jsx)("span",{style:{color:"#007bff"},children:(0,a.renderNick)(e.nombre)})}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.ganados}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.perdidos}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.preguntasAcertadas}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.preguntasFalladas}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.likes})]},s))})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-3 w-1/2 text-[11px]",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-center mb-4",children:"CompeticiÃ³n Individual"}),(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-green-100",children:[(0,t.jsx)("th",{className:"py-2 text-center",children:"PG"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"EC"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"A"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"G"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"P"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"PA"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"PF"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"â¤ï¸"})]})}),(0,t.jsx)("tbody",{children:j.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-0 text-center font-bold",children:s+1}),(0,t.jsx)("td",{className:"py-0 text-center",children:(0,t.jsx)("span",{className:"inline-block w-8 h-8 text-2xl align-middle",children:e.escudo})}),(0,t.jsx)("td",{className:"py-0 font-semibold",children:(0,t.jsx)("span",{style:{color:"#007bff"},children:(0,a.renderNick)(e.nombre)})}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.ganados}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.perdidos}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.preguntasAcertadas}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.preguntasFalladas}),(0,t.jsx)("td",{className:"py-0 text-center",children:e.likes})]},s))})]})]})]}),(0,t.jsxs)("div",{className:"bg-yellow-50 rounded-lg shadow-md p-3 w-full max-w-7xl mx-auto text-[11px]",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-center mb-4",children:"CompeticiÃ³n Docentes"}),(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-yellow-100",children:[(0,t.jsx)("th",{className:"py-2 text-center",children:"PG"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"EC"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"Docente"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"G"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"P"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"PA"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"PF"}),(0,t.jsx)("th",{className:"py-2 text-center",children:"â¤ï¸"})]})}),(0,t.jsx)("tbody",{children:N.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-1 text-center font-bold",children:s+1}),(0,t.jsx)("td",{className:"py-1 text-center",children:(0,t.jsx)("span",{className:"inline-block w-8 h-8 text-2xl align-middle",children:e.escudo})}),(0,t.jsx)("td",{className:"py-1 font-semibold",children:(0,t.jsx)("span",{style:{color:"#007bff"},children:(0,a.renderNick)(e.nombre)})}),(0,t.jsx)("td",{className:"py-1 text-center",children:e.ganados}),(0,t.jsx)("td",{className:"py-1 text-center",children:e.perdidos}),(0,t.jsx)("td",{className:"py-1 text-center",children:e.preguntasAcertadas}),(0,t.jsx)("td",{className:"py-1 text-center",children:e.preguntasFalladas}),(0,t.jsx)("td",{className:"py-1 text-center",children:e.likes})]},s))})]})]}),(0,t.jsxs)("div",{className:"bg-green-50 rounded-lg shadow p-4 w-full mt-4",children:[(0,t.jsx)("h3",{className:"font-bold mb-2",children:"Significado de las siglas:"}),(0,t.jsxs)("ul",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:"PG"}),": PosiciÃ³n Global"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:"EC"}),": Escudo Centro / Avatar"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:"CE"}),": Nombre del Centro"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:"A"}),": Alumno"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:"G"}),": Ganados"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:"P"}),": Perdidos"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:"PA"}),": Preguntas Acertadas"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:"PF"}),": Preguntas Falladas"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:"â¤ï¸"}),": Likes"]})]})]})]})]})}e.s(["default",()=>l])}]);