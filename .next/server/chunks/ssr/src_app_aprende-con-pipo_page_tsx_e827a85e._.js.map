{"version":3,"sources":["turbopack:///[project]/src/app/aprende-con-pipo/page.tsx"],"sourcesContent":["\"use client\";\r\n// Tabla individual de docentes por temporada\r\nfunction getTablaDocentes(temporada: number) {\r\n    if (typeof window === \"undefined\") return {};\r\n    const key = `campeonato_individual_t${temporada}`;\r\n    const tabla = JSON.parse(localStorage.getItem(key) || '{}');\r\n    // Filtrar solo docentes\r\n    const usersStr = localStorage.getItem(\"users\");\r\n    if (!usersStr) return {};\r\n    const usersArr = JSON.parse(usersStr);\r\n    const docentes = usersArr.filter((u: any) => u.tipo === \"Docente\");\r\n    const resultado: Record<string, number> = {};\r\n    docentes.forEach((doc: any) => {\r\n        if (tabla[doc.nick]) {\r\n            resultado[doc.nick] = tabla[doc.nick];\r\n        }\r\n    });\r\n    // Ordenar y limitar a los 25 mejores\r\n    const ordenados = Object.entries(resultado)\r\n        .sort((a, b) => (b[1] as number) - (a[1] as number))\r\n        .slice(0, 25);\r\n    return Object.fromEntries(ordenados);\r\n}\r\nimport React from \"react\";\r\nimport ChampionshipQuiz from \"../../components/ChampionshipQuiz\";\r\n\r\nexport default function AprendeConPipo() {\r\n    // Estado para mostrar modo competici√≥n\r\n    const [modoCompeticion, setModoCompeticion] = React.useState(false);\r\n    // Estado para curso seleccionado en ChampionshipQuiz\r\n    const [cursoCompeticion, setCursoCompeticion] = React.useState(1);\r\n    // Estado para centro escolar (puedes adaptar seg√∫n tu l√≥gica de usuario)\r\n    const [centroCompeticion, setCentroCompeticion] = React.useState(\"\");\r\n    // Ejemplo de cursos y asignaturas\r\n    const cursos = [\"1¬∫ Primaria\", \"2¬∫ Primaria\", \"3¬∫ Primaria\", \"4¬∫ Primaria\", \"5¬∫ Primaria\", \"6¬∫ Primaria\"];\r\n    const asignaturas = [\"Naturaleza\", \"Matem√°ticas\", \"Lenguaje\", \"Literatura\", \"Ingl√©s\", \"Geograf√≠a\", \"Historia\", \"General\", \"Campeonato\"];\r\n\r\n    // L√≥gica de temporada\r\n    function getCurrentSeason() {\r\n        const now = new Date();\r\n        const year = now.getFullYear();\r\n        // Temporada inicia el 1 de octubre y termina el 30 de septiembre del siguiente a√±o\r\n        if (now.getMonth() + 1 < 10) {\r\n            // Antes de octubre, temporada es del a√±o anterior\r\n            return year - 1;\r\n        }\r\n        return year;\r\n    }\r\n    // Obtener todas las temporadas guardadas\r\n    function getTemporadasDisponibles() {\r\n        const temporadas: number[] = [];\r\n        for (let i = 2023; i <= getCurrentSeason(); i++) {\r\n            // Si existe alguna tabla individual o centro para esa temporada, la mostramos\r\n            if (localStorage.getItem(`campeonato_individual_t${i}`) || localStorage.getItem(`campeonato_centro_t${i}`)) {\r\n                temporadas.push(i);\r\n            }\r\n        }\r\n        // Siempre mostrar la actual aunque no tenga datos\r\n        if (!temporadas.includes(getCurrentSeason())) {\r\n            temporadas.push(getCurrentSeason());\r\n        }\r\n        return temporadas.sort((a, b) => b - a); // Descendente\r\n    }\r\n\r\n    // Estado para temporada seleccionada\r\n    const [temporadaSeleccionada, setTemporadaSeleccionada] = React.useState<number>(getCurrentSeason());\r\n\r\n    // Actualizar temporada seleccionada desde el desplegable\r\n    function handleTemporadaChange(e: React.ChangeEvent<HTMLSelectElement>) {\r\n        setTemporadaSeleccionada(Number(e.target.value));\r\n    }\r\n\r\n    // Likes individuales por temporada\r\n    function getLikesIndividual(nick: string, temporada: number): number {\r\n        if (typeof window === \"undefined\") return 0;\r\n        const key = `campeonato_individual_t${temporada}`;\r\n        const tabla = JSON.parse(localStorage.getItem(key) || '{}');\r\n        return tabla[nick] || 0;\r\n    }\r\n\r\n    function getLikesCentro(centro: string, temporada: number): number {\r\n        if (typeof window === \"undefined\") return 0;\r\n        const key = `campeonato_centro_t${temporada}`;\r\n        const tabla = JSON.parse(localStorage.getItem(key) || '{}');\r\n        return tabla[centro] || 0;\r\n    }\r\n\r\n    function sumarLikes(nick: string, centro: string, cantidad: number): void {\r\n        if (typeof window === \"undefined\") return;\r\n        const keyInd = `campeonato_individual_t${getCurrentSeason()}`;\r\n        const tablaInd = JSON.parse(localStorage.getItem(keyInd) || '{}');\r\n        tablaInd[nick] = (tablaInd[nick] || 0) + cantidad;\r\n        localStorage.setItem(keyInd, JSON.stringify(tablaInd));\r\n        const keyCentro = `campeonato_centro_t${getCurrentSeason()}`;\r\n        const tablaCentro = JSON.parse(localStorage.getItem(keyCentro) || '{}');\r\n        tablaCentro[centro] = (tablaCentro[centro] || 0) + cantidad;\r\n        localStorage.setItem(keyCentro, JSON.stringify(tablaCentro));\r\n    }\r\n\r\n    function sumarLikesPerfil(nick: string, cantidad: number): void {\r\n        if (typeof window === \"undefined\") return;\r\n        // Actualizar solo el campo likes en el objeto del usuario en localStorage\r\n        const usersStr = localStorage.getItem(\"users\");\r\n        if (usersStr) {\r\n            const usersArr = JSON.parse(usersStr);\r\n            const idx = usersArr.findIndex((u: any) => u.nick === nick);\r\n            if (idx !== -1) {\r\n                usersArr[idx].likes = (parseFloat(usersArr[idx].likes) || 0) + cantidad;\r\n                localStorage.setItem(\"users\", JSON.stringify(usersArr));\r\n            }\r\n        }\r\n        // Actualizar tambi√©n el objeto user\r\n        const userStr = localStorage.getItem(\"user\");\r\n        if (userStr) {\r\n            const userObj = JSON.parse(userStr);\r\n            if (userObj.nick === nick) {\r\n                userObj.likes = (parseFloat(userObj.likes) || 0) + cantidad;\r\n                localStorage.setItem(\"user\", JSON.stringify(userObj));\r\n            }\r\n        }\r\n    }\r\n\r\n    function getTablaIndividual(temporada: number) {\r\n        if (typeof window === \"undefined\") return {};\r\n        const key = `campeonato_individual_t${temporada}`;\r\n        return JSON.parse(localStorage.getItem(key) || '{}');\r\n    }\r\n    function getTablaCentro(temporada: number) {\r\n        if (typeof window === \"undefined\") return {};\r\n        const key = `campeonato_centro_t${temporada}`;\r\n        return JSON.parse(localStorage.getItem(key) || '{}');\r\n    }\r\n\r\n    // Estado para selecci√≥n de curso y asignatura - SISTEMA ANTI-TRAMPA\r\n    const [usuarioActual, setUsuarioActual] = React.useState<any>(null);\r\n    const [cursoUsuario, setCursoUsuario] = React.useState<string>(\"1¬∫ Primaria\");\r\n    const [asignaturaSeleccionada, setAsignaturaSeleccionada] = React.useState<string>(\"Matem√°ticas\");\r\n    const [preguntaActual, setPreguntaActual] = React.useState<string>(\"\");\r\n    const [objetoPreguntaActual, setObjetoPreguntaActual] = React.useState<any>(null);\r\n    const [respuestaCorrecta, setRespuestaCorrecta] = React.useState<string>(\"\");\r\n    const [respuestaUsuario, setRespuestaUsuario] = React.useState<string>(\"\");\r\n    const [feedback, setFeedback] = React.useState<string>(\"\");\r\n    // Estado para el temporizador: 5 minutos (300 segundos)\r\n    const [timeLeft, setTimeLeft] = React.useState<number>(300); // 5 minutos por pregunta\r\n    const [bloqueado, setBloqueado] = React.useState<boolean>(false);\r\n\r\n    // ‚úÖ SISTEMA ANTI-TRAMPA: Cargar usuario autom√°ticamente al iniciar\r\n    React.useEffect(() => {\r\n        if (typeof window === \"undefined\") return;\r\n\r\n        const userStr = localStorage.getItem(\"currentUser\") || localStorage.getItem(\"user\");\r\n        if (userStr) {\r\n            try {\r\n                const userObj = JSON.parse(userStr);\r\n                setUsuarioActual(userObj);\r\n\r\n                // ‚úÖ SISTEMA DOCENTES: Detectar curso del usuario autom√°ticamente\r\n                let cursoDetectado = \"1¬∫ Primaria\";\r\n\r\n                // Si es docente, usar 6¬∫ curso por defecto (preguntas m√°s dif√≠ciles)\r\n                const esDocente = userObj.esProfesor || userObj.tipo === \"docente\" || userObj.tipo === \"Docente\";\r\n\r\n                if (esDocente) {\r\n                    cursoDetectado = \"6¬∫ Primaria\";\r\n                } else if (userObj.curso) {\r\n                    // Para estudiantes, usar su curso real\r\n                    if (typeof userObj.curso === \"string\") {\r\n                        const match = userObj.curso.match(/(\\d)/);\r\n                        if (match) {\r\n                            const numero = parseInt(match[1]);\r\n                            cursoDetectado = `${numero}¬∫ Primaria`;\r\n                        }\r\n                    } else if (typeof userObj.curso === \"number\") {\r\n                        cursoDetectado = `${userObj.curso}¬∫ Primaria`;\r\n                    }\r\n                }\r\n                setCursoUsuario(cursoDetectado);\r\n\r\n            } catch (error) {\r\n                console.error(\"Error cargando datos del usuario:\", error);\r\n            }\r\n        }\r\n    }, []);\r\n\r\n    // Temporizador para modo cl√°sico\r\n    React.useEffect(() => {\r\n        if (!preguntaActual || bloqueado) return;\r\n        if (timeLeft === 0) {\r\n            setBloqueado(true);\r\n            setFeedback(\"‚è∞ Tiempo agotado. No puedes responder esta pregunta. -2 likes\");\r\n            if (typeof window !== \"undefined\") {\r\n                const userStr = localStorage.getItem(\"user\");\r\n                if (userStr) {\r\n                    const userObj = JSON.parse(userStr);\r\n                    sumarLikesPerfil(userObj.nick, -2);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);\r\n        return () => clearTimeout(timer);\r\n    }, [timeLeft, preguntaActual, bloqueado]);\r\n\r\n    // Cargar preguntas de todos los archivos seg√∫n curso autom√°tico y materia\r\n    const preguntas = React.useMemo(() => {\r\n        let cursoNum = 1;\r\n        if (cursoUsuario) {\r\n            const match = cursoUsuario.match(/(\\d+)/);\r\n            if (match) cursoNum = Number(match[1]);\r\n        }\r\n        const materias = [\r\n            \"matematicas\", \"lenguaje\", \"literatura\", \"historia\", \"geografia\", \"naturaleza\", \"ingles\", \"general\", \"campeonato\"\r\n        ];\r\n        let todas: any[] = [];\r\n        for (const materia of materias) {\r\n            try {\r\n                // @ts-ignore\r\n                const preguntasMateria = require(`../../questions/${materia}-${cursoNum}primaria.json`);\r\n                todas = todas.concat(preguntasMateria);\r\n            } catch {\r\n                // Si no existe el archivo, lo ignora\r\n            }\r\n        }\r\n        return todas;\r\n    }, [cursoUsuario]);\r\n\r\n    // Filtrar preguntas por asignatura\r\n    const preguntasFiltradas = React.useMemo(() => {\r\n        if (asignaturaSeleccionada === \"General\") return preguntas;\r\n        // Filtrar solo preguntas con categoria igual a la asignatura seleccionada\r\n        const filtradas = preguntas.filter((p: any) => p.categoria === asignaturaSeleccionada);\r\n        return filtradas;\r\n    }, [preguntas, asignaturaSeleccionada]);\r\n\r\n    // Estado para preguntas ya usadas en la sesi√≥n\r\n    const [preguntasUsadas, setPreguntasUsadas] = React.useState<string[]>([]);\r\n\r\n    function generarPregunta() {\r\n        if (preguntasFiltradas.length === 0) {\r\n            setPreguntaActual(\"\");\r\n            setObjetoPreguntaActual(null);\r\n            setRespuestaCorrecta(\"\");\r\n            setFeedback(\"No hay preguntas para esta asignatura.\");\r\n            setBloqueado(false);\r\n            setTimeLeft(300);\r\n            setPreguntasUsadas([]);\r\n            return;\r\n        }\r\n        // Filtrar preguntas no usadas\r\n        const restantes = preguntasFiltradas.filter((p: any) => !preguntasUsadas.includes(p.pregunta));\r\n        if (restantes.length === 0) {\r\n            setPreguntaActual(\"\");\r\n            setObjetoPreguntaActual(null);\r\n            setRespuestaCorrecta(\"\");\r\n            setFeedback(\"¬°Has respondido todas las preguntas disponibles!\");\r\n            setBloqueado(true);\r\n            setTimeLeft(300);\r\n            setPreguntasUsadas([]);\r\n            return;\r\n        }\r\n        const random = Math.floor(Math.random() * restantes.length);\r\n        const preguntaSeleccionada = restantes[random];\r\n        setPreguntaActual(preguntaSeleccionada.pregunta);\r\n        setObjetoPreguntaActual(preguntaSeleccionada);  // Guardar objeto completo\r\n        setRespuestaCorrecta(preguntaSeleccionada.respuesta);\r\n        setRespuestaUsuario(\"\");\r\n        setFeedback(\"\");\r\n        setBloqueado(false);\r\n        setTimeLeft(300);\r\n        setPreguntasUsadas([...preguntasUsadas, preguntaSeleccionada.pregunta]);\r\n    }\r\n\r\n    {/* Tabla Docentes */ }\r\n    <div className=\"mt-8\">\r\n        <h2 className=\"text-xl font-bold mb-2\">Ranking Docentes</h2>\r\n        <table className=\"w-full border mb-4\" style={{ backgroundColor: '#fffbe6' }}>\r\n            <thead>\r\n                <tr style={{ backgroundColor: '#fff9c4' }}>\r\n                    <th className=\"p-2\">Docente</th>\r\n                    <th className=\"p-2\">Likes</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                {Object.entries(getTablaDocentes(temporadaSeleccionada)).map(([nick, likes]) => (\r\n                    <tr key={nick}>\r\n                        <td className=\"border p-2\">{nick}</td>\r\n                        <td className=\"border p-2\">{likes}</td>\r\n                    </tr>\r\n                ))}\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n    // Mover la funci√≥n comprobarRespuesta fuera del return y asegurar que el return solo contiene JSX\r\n    function comprobarRespuesta() {\r\n        if (bloqueado) return;\r\n        let likesDelta = 0;\r\n\r\n        // ‚úÖ SISTEMA DOCENTES: Detectar si es docente para ajustar puntuaci√≥n\r\n        const esDocente = usuarioActual?.esProfesor || usuarioActual?.tipo === \"docente\" || usuarioActual?.tipo === \"Docente\";\r\n        const multiplicadorDocente = esDocente ? 0.5 : 1; // Los docentes reciben la mitad de puntos\r\n\r\n        function normalizar(str: string) {\r\n            return str.toLowerCase().normalize(\"NFD\").replace(/\\p{Diacritic}/gu, \"\").replace(/\\s+/g, \"\").trim();\r\n        }\r\n        const esCorrecta = normalizar(respuestaUsuario) === normalizar(respuestaCorrecta);\r\n        setBloqueado(true);\r\n        if (esCorrecta) {\r\n            if (timeLeft > 120) {\r\n                const puntosBase = 1 * multiplicadorDocente;\r\n                setFeedback(`¬°Correcto! üéâ +${puntosBase} like${puntosBase !== 1 ? 's' : ''}${esDocente ? ' (Docente: 50% puntos)' : ''}`);\r\n                likesDelta = puntosBase;\r\n            } else {\r\n                const puntosBase = 0.5 * multiplicadorDocente;\r\n                setFeedback(`¬°Correcto! üéâ +${puntosBase} likes${esDocente ? ' (Docente: 50% puntos)' : ''}`);\r\n                likesDelta = puntosBase;\r\n            }\r\n            // Guardar respuestas acertadas en localStorage para el perfil y en users\r\n            if (typeof window !== \"undefined\") {\r\n                const userStr = localStorage.getItem(\"user\");\r\n                const usersStr = localStorage.getItem(\"users\");\r\n                if (userStr && usersStr) {\r\n                    const userObj = JSON.parse(userStr);\r\n\r\n                    // Guardar total general de respuestas acertadas\r\n                    const keyAcertadas = `acertadas_${userObj.nick}`;\r\n                    const totalAcertadas = parseInt(localStorage.getItem(keyAcertadas) || '0', 10);\r\n                    localStorage.setItem(keyAcertadas, String(totalAcertadas + 1));\r\n\r\n                    // ‚úÖ NUEVO: Guardar respuestas acertadas por asignatura espec√≠fica\r\n                    if (objetoPreguntaActual && objetoPreguntaActual.categoria) {\r\n                        const asignaturaNormalizada = objetoPreguntaActual.categoria.toLowerCase();\r\n\r\n                        // Mapear categor√≠as a nombres de asignatura consistentes para localStorage\r\n                        const mapaAsignaturas: { [key: string]: string } = {\r\n                            'matem√°ticas': 'matematicas',\r\n                            'historia': 'historia',\r\n                            'geograf√≠a': 'geografia',\r\n                            'literatura': 'literatura',\r\n                            'ingl√©s': 'ingles',\r\n                            'naturaleza': 'naturaleza',\r\n                            'lenguaje': 'lenguaje',\r\n                            'general': 'general'\r\n                        };\r\n                        const asignaturaFinal = mapaAsignaturas[asignaturaNormalizada] || asignaturaNormalizada;\r\n                        const keyAsignatura = `${asignaturaFinal}_${userObj.nick}`;\r\n                        const totalAsignatura = parseInt(localStorage.getItem(keyAsignatura) || '0', 10);\r\n                        localStorage.setItem(keyAsignatura, String(totalAsignatura + 1));\r\n                    }\r\n\r\n                    // Actualizar campo preguntasAcertadas en users\r\n                    const usersArr = JSON.parse(usersStr);\r\n                    const idx = usersArr.findIndex((u: any) => u.nick === userObj.nick);\r\n                    if (idx !== -1) {\r\n                        usersArr[idx].preguntasAcertadas = (usersArr[idx].preguntasAcertadas || 0) + 1;\r\n                        localStorage.setItem(\"users\", JSON.stringify(usersArr));\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (timeLeft > 120) {\r\n                const penalizacionBase = -0.5 * multiplicadorDocente;\r\n                setFeedback(`Incorrecto. La respuesta era: ${respuestaCorrecta} ${penalizacionBase} likes${esDocente ? ' (Docente: 50% puntos)' : ''}`);\r\n                likesDelta = penalizacionBase;\r\n            } else {\r\n                const penalizacionBase = -1 * multiplicadorDocente;\r\n                setFeedback(`Incorrecto. La respuesta era: ${respuestaCorrecta} ${penalizacionBase} like${Math.abs(penalizacionBase) !== 1 ? 's' : ''}${esDocente ? ' (Docente: 50% puntos)' : ''}`);\r\n                likesDelta = penalizacionBase;\r\n            }\r\n            // Guardar preguntas falladas en users\r\n            if (typeof window !== \"undefined\") {\r\n                const userStr = localStorage.getItem(\"user\");\r\n                const usersStr = localStorage.getItem(\"users\");\r\n                if (userStr && usersStr) {\r\n                    const userObj = JSON.parse(userStr);\r\n                    const usersArr = JSON.parse(usersStr);\r\n                    const idx = usersArr.findIndex((u: any) => u.nick === userObj.nick);\r\n                    if (idx !== -1) {\r\n                        usersArr[idx].preguntasFalladas = (usersArr[idx].preguntasFalladas || 0) + 1;\r\n                        localStorage.setItem(\"users\", JSON.stringify(usersArr));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (typeof window !== \"undefined\") {\r\n            const userStr = localStorage.getItem(\"user\");\r\n            if (userStr) {\r\n                const userObj = JSON.parse(userStr);\r\n                sumarLikesPerfil(userObj.nick, likesDelta);\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-green-100 p-8 flex flex-col items-center\">\r\n            <h1 className=\"text-2xl font-bold mb-4 text-center\">Aprende con Pipo</h1>\r\n            <div className=\"flex items-stretch mx-auto\" style={{ transform: 'translateX(-80px)' }}>\r\n                <img src=\"/trofeo16.jpg\" alt=\"Trofeo 16\" className=\"h-40 object-contain mr-4\" />\r\n                <div className=\"max-w-2xl w-full bg-white rounded-lg shadow-md p-8 flex flex-col gap-6 mx-auto\">\r\n                    {!modoCompeticion ? (\r\n                        <>\r\n                            {/* ‚úÖ SISTEMA ANTI-TRAMPA: Informaci√≥n del usuario detectada autom√°ticamente */}\r\n                            <div className=\"bg-gradient-to-r from-blue-50 to-green-50 p-4 rounded-lg border-2 border-blue-200 mb-4\">\r\n                                <h3 className=\"text-lg font-bold text-blue-800 mb-2\">üõ°Ô∏è Sistema Anti-Trampa Activo</h3>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n                                    <div>\r\n                                        <span className=\"font-semibold text-blue-700\">üë§ Usuario:</span>\r\n                                        <span className=\"ml-2 text-gray-800\">{usuarioActual?.nick || \"No detectado\"}</span>\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"font-semibold text-blue-700\">üéì Curso detectado:</span>\r\n                                        <span className=\"ml-2 text-gray-800 font-semibold\">{cursoUsuario}</span>\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"font-semibold text-blue-700\">üè´ Centro:</span>\r\n                                        <span className=\"ml-2 text-gray-800\">{usuarioActual?.centro || \"No asignado\"}</span>\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"font-semibold text-blue-700\">üë• Tipo:</span>\r\n                                        <span className=\"ml-2 text-gray-800\">\r\n                                            {(usuarioActual?.esProfesor || usuarioActual?.tipo === \"docente\" || usuarioActual?.tipo === \"Docente\") ? \"Docente\" : \"Estudiante\"}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded\">\r\n                                    <p className=\"text-xs text-yellow-800\">\r\n                                        üîí <strong>Solo podr√°s responder preguntas de tu nivel</strong> para garantizar puntuaciones justas.\r\n                                    </p>\r\n                                    {(usuarioActual?.esProfesor || usuarioActual?.tipo === \"docente\" || usuarioActual?.tipo === \"Docente\") && (\r\n                                        <p className=\"text-xs text-orange-800 mt-2\">\r\n                                            üë©‚Äçüè´ <strong>Modo Docente:</strong> Preguntas de 6¬∫ curso y puntuaci√≥n reducida al 50% para equilibrar la dificultad.\r\n                                        </p>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex flex-col md:flex-row gap-4 items-center justify-center\">\r\n                                <label className=\"font-semibold\">Asignatura:</label>\r\n                                <select className=\"border rounded px-2 py-1\" value={asignaturaSeleccionada} onChange={e => setAsignaturaSeleccionada(e.target.value)}>\r\n                                    {asignaturas.map(a => <option key={a} value={a}>{a}</option>)}\r\n                                </select>\r\n                                <div className=\"text-sm text-gray-600\">\r\n                                    (Curso fijo: <strong>{cursoUsuario}</strong>)\r\n                                </div>\r\n                            </div>\r\n                            <button className=\"bg-blue-500 text-white px-4 py-2 rounded mt-4\" onClick={generarPregunta}>\r\n                                Generar pregunta\r\n                            </button>\r\n                            <button className=\"bg-orange-500 text-white px-4 py-2 rounded mt-4 self-center\" onClick={() => {\r\n                                // Obtener curso y centro escolar del usuario desde localStorage\r\n                                let cursoUsuario = 1;\r\n                                let centroUsuario = \"\";\r\n                                if (typeof window !== \"undefined\") {\r\n                                    const userStr = localStorage.getItem(\"user\");\r\n                                    if (userStr) {\r\n                                        const userObj = JSON.parse(userStr);\r\n                                        // El curso puede estar como n√∫mero (1-6) o como texto (\"6¬∫\", \"5¬∫\", ...)\r\n                                        let cursoNum = 1;\r\n                                        if (userObj.curso) {\r\n                                            if (typeof userObj.curso === \"string\") {\r\n                                                const match = userObj.curso.match(/(\\d)/);\r\n                                                if (match) cursoNum = Number(match[1]);\r\n                                            } else if (typeof userObj.curso === \"number\") {\r\n                                                cursoNum = userObj.curso;\r\n                                            }\r\n                                        }\r\n                                        if (!isNaN(cursoNum) && cursoNum >= 1 && cursoNum <= 6) {\r\n                                            cursoUsuario = cursoNum;\r\n                                        }\r\n                                        // Centro escolar\r\n                                        if (userObj.centro) {\r\n                                            centroUsuario = userObj.centro;\r\n                                        }\r\n                                    }\r\n                                }\r\n                                setModoCompeticion(true);\r\n                                setCursoCompeticion(cursoUsuario);\r\n                                setCentroCompeticion(centroUsuario);\r\n                            }}>\r\n                                Modo competici√≥n\r\n                            </button>\r\n                            {preguntaActual && (\r\n                                <div className=\"mt-4\">\r\n                                    <div className=\"font-semibold mb-2\">{preguntaActual}</div>\r\n                                    <div className=\"font-bold text-lg mb-2\">‚è∞ Tiempo: {Math.floor(timeLeft / 60)}:{(timeLeft % 60).toString().padStart(2, '0')} min</div>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        className=\"border rounded px-2 py-1 w-full mb-2\"\r\n                                        value={respuestaUsuario}\r\n                                        onChange={e => setRespuestaUsuario(e.target.value)}\r\n                                        placeholder=\"Escribe tu respuesta aqu√≠\"\r\n                                        disabled={bloqueado}\r\n                                    />\r\n                                    <button className=\"bg-green-500 text-white px-4 py-2 rounded\" onClick={comprobarRespuesta} disabled={bloqueado}>\r\n                                        Comprobar respuesta\r\n                                    </button>\r\n                                    {feedback && <div className=\"mt-2 font-bold\">{feedback}</div>}\r\n                                </div>\r\n                            )}\r\n                            {feedback && !preguntaActual && <div className=\"mt-2 font-bold text-red-600\">{feedback}</div>}\r\n                        </>\r\n                    ) : (\r\n                        <div className=\"mt-4\">\r\n                            <ChampionshipQuiz userGrade={cursoCompeticion} userSchool={centroCompeticion} />\r\n                            <button className=\"bg-gray-500 text-white px-4 py-2 rounded mt-4\" onClick={() => setModoCompeticion(false)}>\r\n                                Salir de competici√≥n\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                <img src=\"/logo-pipo.jpg\" alt=\"Logo Pipo\" className=\"h-40 object-contain ml-4\" />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}