module.exports=[68384,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.s(["default",0,({userGrade:d,userSchool:e})=>{let[f,g]=c.default.useState(""),[h,i]=c.default.useState(""),[j,k]=c.default.useState(""),[l,m]=c.default.useState(""),[n,o]=c.default.useState([]),[p,q]=c.default.useState(300),[r,s]=c.default.useState(!1),[t,u]=c.default.useState(null),[v,w]=c.default.useState([]);c.default.useEffect(()=>{(async()=>{try{let a=await fetch("/api/auth/me");if(a.ok){let b=await a.json();u(b)}}catch(a){console.error("Error loading user:",a)}})()},[]);let x=async a=>{if(t)try{let b=await fetch("/api/user/update-likes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({likesDelta:a})});if(b.ok){let a=await b.json();u(a),window.dispatchEvent(new Event("profileUpdate"))}}catch(a){console.error("Error updating likes:",a)}},y=async a=>{try{(await fetch("/api/stats/championship",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok||console.error("Error updating championship stats")}catch(a){console.error("Error updating championship stats:",a)}};c.default.useEffect(()=>{if(!f||r)return;if(0===p){s(!0),m("â° Tiempo agotado. No puedes responder esta pregunta. -3 likes"),x(-3);return}let a=setTimeout(()=>q(p-1),1e3);return()=>clearTimeout(a)},[p,f,r]);let z=[];try{z=a.f({"../questions/campeonato-1primaria.json":{id:()=>5251,module:()=>a.r(5251)},"../questions/campeonato-2primaria.json":{id:()=>31668,module:()=>a.r(31668)},"../questions/campeonato-3primaria.json":{id:()=>85700,module:()=>a.r(85700)},"../questions/campeonato-4primaria.json":{id:()=>8433,module:()=>a.r(8433)},"../questions/campeonato-5primaria.json":{id:()=>59447,module:()=>a.r(59447)},"../questions/campeonato-6primaria.json":{id:()=>6959,module:()=>a.r(6959)}})(`../questions/campeonato-${d}primaria.json`)}catch{z=[]}return(0,b.jsxs)("div",{className:"p-4 bg-yellow-100 rounded-lg",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Modo Campeonato"}),(0,b.jsxs)("p",{children:["Curso seleccionado: ",d,"Âº Primaria"]}),(0,b.jsxs)("p",{children:["Centro escolar: ",e||"No especificado"]}),(0,b.jsx)("button",{className:"bg-blue-500 text-white px-4 py-2 rounded mt-2",onClick:function(){if(n.length>=25){if(g(""),i(""),m("Â¡Has completado las 25 preguntas del campeonato!"),s(!0),t){let a=new Date,b=a.getFullYear();a.getMonth()+1>=10&&(b+=1);let c=`t${b}`,d=v.filter(a=>a.correcta).length,e=v.filter(a=>!a.correcta).length,f=v.reduce((a,b)=>a+(b.likes||0),0);y({nick:t.nick,centro:t.centro,curso:t.curso,temporada:c,acertadas:d,falladas:e,likes:f,ganado:+(d>12),perdido:+(d<=12),tipo:t.tipo}),w([])}return}q(300),s(!1);let a=z.filter(a=>!n.includes(a.pregunta));if(0===a.length){g(""),i(""),m("Â¡No hay mÃ¡s preguntas disponibles en el banco!"),s(!0);return}let b=Math.floor(Math.random()*a.length);g(a[b].pregunta),i(a[b].respuesta),k(""),m(""),o([...n,a[b].pregunta])},children:"Generar pregunta de campeonato"}),f&&(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("div",{className:"font-semibold mb-2",children:f}),(0,b.jsxs)("div",{className:"font-bold text-lg mb-2",children:["â° Tiempo: ",Math.floor(p/60),":",(p%60).toString().padStart(2,"0")," min"]}),(0,b.jsx)("input",{type:"text",className:"border rounded px-2 py-1 w-full mb-2",value:j,onChange:a=>k(a.target.value),placeholder:"Escribe tu respuesta aquÃ­",disabled:r}),(0,b.jsx)("button",{className:"bg-green-500 text-white px-4 py-2 rounded",onClick:function(){function a(a){return a.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/\s+/g,"").trim()}if(r)return;let b=a(j)===a(h);s(!0);let c=0;b?(m("Â¡Correcto! ðŸŽ‰"),c=p>120?2:1):(m(`Incorrecto. La respuesta era: ${h}`),c=p>120?-1:-2),x(c);let d={pregunta:f,respuestaUsuario:j,respuestaCorrecta:h,correcta:b,tiempo:p,likes:c};w(a=>[...a,d])},disabled:r,children:"Enviar respuesta"}),l&&(0,b.jsx)("div",{className:"mt-2 font-bold",children:l})]}),l&&!f&&(0,b.jsx)("div",{className:"mt-2 font-bold text-red-600",children:l})]})}])}];

//# sourceMappingURL=src_components_ChampionshipQuiz_tsx_7116ac0b._.js.map