{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","turbopack:///[project]/src/app/perfil/avatar/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","\"use client\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nconst AvatarSelector: React.FC = () => {\r\n    const router = useRouter();\r\n    const [user, setUser] = useState<any>(null);\r\n    const [selectedAvatar, setSelectedAvatar] = useState(\"\");\r\n    const [loading, setLoading] = useState(true);\r\n    const [saving, setSaving] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const loadUser = async () => {\r\n            try {\r\n                const response = await fetch('/api/auth/me');\r\n                if (response.ok) {\r\n                    const data = await response.json();\r\n                    setUser(data.user);\r\n                } else {\r\n                    router.push('/login');\r\n                    return;\r\n                }\r\n            } catch (error) {\r\n                console.error('Error loading user:', error);\r\n                router.push('/login');\r\n                return;\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        loadUser();\r\n    }, [router]);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen bg-green-100 flex items-center justify-center\">\r\n                <div className=\"text-center\">\r\n                    <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-900 mx-auto mb-4\"></div>\r\n                    <p>Cargando...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!user) {\r\n        return (\r\n            <div className=\"min-h-screen bg-green-100 flex items-center justify-center\">\r\n                <div className=\"text-center\">\r\n                    <p>No se pudo cargar la informaciÃ³n del usuario.</p>\r\n                    <button\r\n                        className=\"mt-4 bg-blue-500 text-white px-4 py-2 rounded\"\r\n                        onClick={() => router.push('/login')}\r\n                    >\r\n                        Ir al login\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const isPremium = user.premium || false;\r\n\r\n    const simpleAvatars = [\r\n        '/avatars/simple1.png',\r\n        ...Array.from({ length: 29 }, (_, i) => `/avatars/simple${i + 2}.jpg`)\r\n    ];\r\n    const premiumAvatars = Array.from({ length: 50 }, (_, i) => `/avatars/apremium${i + 1}.jpg`);\r\n\r\n    // Mostrar todos los avatares siempre, pero marcar cuÃ¡les son premium\r\n    const allAvatars = [...simpleAvatars, ...premiumAvatars];\r\n    const premiumAvatarIndices = simpleAvatars.length; // Ãndice donde empiezan los premium\r\n\r\n    const handleSelectAvatar = (avatar: string) => {\r\n        setSelectedAvatar(avatar);\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        if (!selectedAvatar || saving) return;\r\n\r\n        // Verificar si el avatar seleccionado es premium y el usuario no es premium\r\n        const isSelectedPremium = premiumAvatars.includes(selectedAvatar);\r\n        if (isSelectedPremium && !isPremium) {\r\n            alert('Este avatar es exclusivo para usuarios Premium. Â¡Hazte Premium para usarlo!');\r\n            return;\r\n        }\r\n\r\n        setSaving(true);\r\n        try {\r\n            const response = await fetch('/api/user/update-avatar', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({ avatar: selectedAvatar }),\r\n            });\r\n\r\n            if (response.ok) {\r\n                alert(\"Avatar actualizado correctamente\");\r\n                router.push(\"/perfil\");\r\n            } else {\r\n                const error = await response.json();\r\n                alert(`Error al actualizar avatar: ${error.error || 'Error desconocido'}`);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error saving avatar:', error);\r\n            alert('Error al guardar el avatar. IntÃ©ntalo de nuevo.');\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-green-100 flex flex-col items-center pt-8\">\r\n            <h1 className=\"text-3xl font-bold mb-4\">Seleccionar Avatar</h1>\r\n\r\n            {/* Indicador de avatares premium */}\r\n            <div className=\"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg max-w-md\">\r\n                <div className=\"flex items-center gap-2 text-yellow-800\">\r\n                    <span className=\"text-lg\">ðŸ‘‘</span>\r\n                    <span className=\"font-semibold\">Avatares Premium</span>\r\n                </div>\r\n                <p className=\"text-sm text-yellow-700 mt-1\">\r\n                    Los avatares con corona dorada son exclusivos para usuarios Premium.\r\n                    {!isPremium && \" Â¡Hazte Premium para desbloquearlos!\"}\r\n                </p>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-5 gap-4 mb-8\">\r\n                {allAvatars.map((avatar, idx) => {\r\n                    const isPremiumAvatar = idx >= premiumAvatarIndices;\r\n                    const canSelect = !isPremiumAvatar || isPremium;\r\n\r\n                    return (\r\n                        <div key={idx} className=\"relative\">\r\n                            <img\r\n                                src={avatar}\r\n                                alt={`Avatar ${idx + 1}${isPremiumAvatar ? ' (Premium)' : ''}`}\r\n                                className={`w-16 h-16 rounded-full border-2 transition-all duration-200 ${!canSelect\r\n                                    ? 'cursor-not-allowed opacity-60 grayscale'\r\n                                    : selectedAvatar === avatar\r\n                                        ? 'border-blue-500 cursor-pointer'\r\n                                        : 'border-gray-300 cursor-pointer hover:border-blue-400'\r\n                                    } ${isPremiumAvatar ? 'ring-2 ring-yellow-400 ring-opacity-50' : ''}`}\r\n                                onClick={() => canSelect && handleSelectAvatar(avatar)}\r\n                                title={isPremiumAvatar && !isPremium ? 'Avatar Premium - Hazte Premium para usarlo' : `Avatar ${idx + 1}`}\r\n                            />\r\n                            {isPremiumAvatar && (\r\n                                <div className=\"absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-xs font-bold text-white shadow-lg\">\r\n                                    ðŸ‘‘\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n            <div className=\"flex gap-4\">\r\n                <button\r\n                    className=\"bg-green-500 text-white px-6 py-3 rounded font-semibold disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                    onClick={handleSave}\r\n                    disabled={!selectedAvatar || saving}\r\n                >\r\n                    {saving ? 'Guardando...' : 'Guardar Avatar'}\r\n                </button>\r\n                <button\r\n                    className=\"bg-gray-500 text-white px-6 py-3 rounded font-semibold\"\r\n                    onClick={() => router.push(\"/perfil\")}\r\n                    disabled={saving}\r\n                >\r\n                    Volver\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AvatarSelector;"],"names":["module","exports","require","vendored","HooksClientContext","ServerInsertedHtml"],"mappings":"gjBAAAA,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRC,QAAQ,CAAC,QAAW,CAACC,kBAAkB,8BCFzCJ,GAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRC,QAAQ,CAAC,QAAW,CAACE,kBAAkB,0CCDzC,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,wBAEiC,KAC7B,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAM,MAChC,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/C,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAyBrC,GAvBA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAoBN,CAnBiB,UACb,GAAI,CACA,IAAM,EAAW,MAAM,MAAM,gBAC7B,IAAI,EAAS,EAAE,CAGR,YACH,EAAO,IAAI,CAAC,SAJC,EACb,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,EAAQ,EAAK,IAAI,CACrB,CAIJ,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,sBAAuB,GACrC,EAAO,IAAI,CAAC,UACZ,MACJ,QAAU,CACN,GAAW,EACf,EACJ,GAGJ,EAAG,CAAC,EAAO,EAEP,EACA,MACI,CAFK,AAEL,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sEACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gFACf,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,qBAMnB,GAAI,CAAC,EACD,IADO,EAEH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sEACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,kDACH,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,UAAU,gDACV,QAAS,IAAM,EAAO,IAAI,CAAC,mBAC9B,qBAQjB,IAAM,EAAY,EAAK,OAAO,GAAI,EAE5B,EAAgB,CAClB,0BACG,MAAM,IAAI,CAAC,CAAE,OAAQ,EAAG,EAAG,CAAC,EAAG,IAAM,CAAC,eAAe,EAAE,EAAI,EAAE,IAAI,CAAC,EACxE,CACK,EAAiB,MAAM,IAAI,CAAC,CAAE,OAAQ,EAAG,EAAG,CAAC,EAAG,IAAM,CAAC,iBAAiB,EAAE,EAAI,EAAE,IAAI,CAAC,EAGrF,EAAa,IAAI,KAAkB,EAAe,CAClD,EAAuB,EAAc,MAAM,CAM3C,CAN6C,CAMhC,UACf,GAAI,AAAC,IAAkB,GAIvB,GAD0B,AACtB,EAJ2B,AAGU,QAAQ,CAAC,CAViC,GAW1D,CAAC,EAAW,YACjC,MAAM,+EAIV,GAAU,GACV,GAAI,CACA,IAAM,EAAW,MAAM,MAAM,0BAA2B,CACpD,OAAQ,OACR,QAAS,CACL,eAAgB,kBACpB,EACA,KAAM,KAAK,SAAS,CAAC,CAAE,OAAQ,CAAe,EAClD,GAEA,GAAI,EAAS,EAAE,CACX,CADa,KACP,oCACN,EAAO,IAAI,CAAC,eACT,CACH,IAAM,EAAQ,MAAM,EAAS,IAAI,GACjC,MAAM,CAAC,4BAA4B,EAAE,EAAM,KAAK,EAAI,oBAAA,CAAqB,CAC7E,CACJ,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,uBAAwB,GACtC,MAAM,kDACV,QAAU,CACN,GAAU,EACd,EACJ,EAEA,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sEACX,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,mCAA0B,uBAGxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+EACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oDACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mBAAU,OAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAgB,wBAEpC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,yCAA+B,uEAEvC,CAAC,GAAa,6CAIvB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uCACV,EAAW,GAAG,CAAC,CAAC,EAAQ,KACrB,IAAM,EAAkB,GAAO,EACzB,EAAY,CAAC,GAAmB,EAEtC,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAc,UAAU,qBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACG,IAAK,EACL,IAAK,CAAC,OAAO,EAAE,EAAM,EAAA,EAAI,EAAkB,aAAe,GAAA,CAAI,CAC9D,UAAW,CAAC,4DAA4D,EAAE,CAAC,EACrE,0CACA,IAAmB,EACf,iCACA,uDACL,CAAC,EAAE,EAAkB,yCAA2C,GAAA,CAAI,CACzE,QAAS,IAAM,QAtEvC,EAsEuE,GAAnB,AAC5B,MAAO,GAAmB,CAAC,EAAY,CAvE7C,4CAuE4F,CAAC,OAAO,EAAE,EAAM,EAAA,CAAG,GAE5G,GACG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gLAAuK,SAdpL,EAoBlB,KAEJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACX,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,UAAU,0GACV,QAAS,EACT,SAAU,CAAC,GAAkB,WAE5B,EAAS,eAAiB,mBAE/B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,UAAU,yDACV,QAAS,IAAM,EAAO,IAAI,CAAC,WAC3B,SAAU,WACb,gBAMjB","ignoreList":[0,1]}